(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{177:function(e,t){function a(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}a.keys=function(){return[]},a.resolve=a,e.exports=a,a.id=177},326:function(e,t,a){e.exports=a.p+"static/media/login_3.c155b94e.jpg"},327:function(e,t,a){e.exports=a.p+"static/media/Logo.ffe9256f.svg"},336:function(e,t,a){e.exports=a(660)},349:function(e,t,a){},401:function(e,t,a){},402:function(e,t,a){},404:function(e,t,a){},552:function(e,t,a){},558:function(e,t,a){},569:function(e,t,a){},610:function(e,t,a){},614:function(e,t){},616:function(e,t){},617:function(e,t){},618:function(e,t){},619:function(e,t){},651:function(e,t,a){},652:function(e,t,a){},655:function(e,t,a){},656:function(e,t,a){},657:function(e,t,a){},659:function(e,t,a){},660:function(e,t,a){"use strict";a.r(t);a(337);var n=a(328),r=a(15),l=a(16),o=a(18),c=a(17),i=a(19),s=a(0),u=a.n(s),d=a(11),m=a.n(d),p=a(35),f=a(111),h=(a(48),a(26)),y=a(29),g=(a(196),a(139)),v=(a(103),a(7)),E=(a(162),a(43)),b=(a(50),a(20)),k=(a(349),[{key:"/docm",title:"\u9879\u76ee\u5408\u540c",role:["normal"]},{key:"/user",title:"\u8d26\u53f7\u7ba1\u7406",role:["admin"]},{key:"/operlog",title:"\u65e5\u5fd7\u5ba1\u8ba1",role:["admin"]},{key:"/account",title:"\u6211\u7684\u8d26\u53f7",role:["normal","admin"]}]),C=h.a.Header,O=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).fetchDefaultSelectedKey=function(e){var t=a.props.location.pathname,n=e.map(function(e){return e.key}),r=n.filter(function(e){return t.indexOf(e)>=0});return r.length<1?[n[0]]:r},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=u.a.createElement(E.b,null,u.a.createElement(E.b.Item,null,u.a.createElement(b.a,{onClick:function(){e.props.history.push("/main/account/mod-pwd")}},"\u4fee\u6539\u5bc6\u7801")),u.a.createElement(E.b.Item,null,u.a.createElement(b.a,{onClick:function(){sessionStorage.removeItem("userId"),setTimeout(function(){e.props.history.push("/login")},300)}},"\u9000\u51fa")));return u.a.createElement(wa.Consumer,null,function(a){var n=k.filter(function(e){return"admin"===a.username?e.role.filter(function(e){return"admin"===e}).length>0:e.role.filter(function(e){return"normal"===e}).length>0}),r=e.fetchDefaultSelectedKey(n);return u.a.createElement("div",null,u.a.createElement(C,{className:"header"},u.a.createElement(E.b,{className:"navbar",theme:"dark",mode:"horizontal",selectedKeys:r,style:{lineHeight:"50px"},onSelect:function(t){var a=e.props,n=a.history,r=a.match;n.push(r.path+t.key)}},n.map(function(e){return u.a.createElement(E.b.Item,{className:"navbar-item",key:e.key},e.title)})),u.a.createElement(E.b,{className:"userbar",theme:"dark",mode:"horizontal",style:{lineHeight:"50px"},selectable:!1},u.a.createElement(E.b.Item,{key:"user"},u.a.createElement(g.a,{overlay:t,placement:"bottomRight"},u.a.createElement("span",null,u.a.createElement(v.a,{style:{fontSize:"18px",color:"#fff"},type:"user"}),u.a.createElement("span",{style:{fontSize:"18px",color:"#fff",margin:"0 8px 0 0"}},a.username),u.a.createElement(v.a,{style:{color:"#fff"},type:"caret-down"})))))))})}}]),t}(s.Component),w=Object(f.g)(O),x=(a(401),a(402),a(167),a(45)),j=(a(404),a(30)),S=a.n(j),D=a(41),I=(a(97),a(33)),T=(a(253),a(189)),N=(a(57),a(8)),A=(a(69),a(23)),F=(a(73),a(32)),M=a(313),P=a.n(M),L=a(62),Y="http://aby.docm.com:8090",z=P.a.create({baseURL:Y,withCredentials:!1,timeout:6e4});z.interceptors.request.use(function(e){var t=sessionStorage.getItem("xAuthToken");return t&&(e.headers["x-auth-token"]=t),e},function(e){console.error("\u8bf7\u6c42\u5f02\u5e38")}),z.interceptors.response.use(function(e){var t=e.headers["x-auth-token"];return t&&sessionStorage.setItem("xAuthToken",t),e},function(e){401===e.response.status&&(sessionStorage.removeItem("userId"),A.a.error("\u767b\u5f55\u8d85\u65f6\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55",3),setTimeout(function(){Object(L.b)().push("/login")},500)),403===e.response.status&&A.a.error("\u60a8\u6ca1\u6709\u8bbf\u95ee\u6743\u9650",3)});var B=z,R=a(121),K=a.n(R),H=h.a.Content,_=F.a.Option,U=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Be,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=Object(y.a)({},t,{password:K()(t.password?t.password:"1234"),dept:{id:t.dept}});B.put("/user",n).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(Be,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.handlePermOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({permissions:e.map(function(e){return{id:e}})}),a.setState({permissions:e})},a.handleDeptOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({dept:e})},a.state={treeData:[],permissions:[],deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;B.get("/perm/all").then(function(t){var a=t.data.data.map(function(e,t){return{key:t,title:e.group,value:void 0,children:e.permissions.map(function(e){return{key:e.id,title:e.name,value:e.id}})}});e.setState({treeData:a})}).catch(function(e){}),B.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})}},{key:"render",value:function(){var e=this,t=this.state,a=t.treeData,n=t.permissions,r=t.deptData;return u.a.createElement(H,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{order:2,flexGrow:1,padding:"0 8px 0 0"}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{block:!0,type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},u.a.createElement(G,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,V,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:this.handleDeptOnChange},r.map(function(e){return u.a.createElement(_,{key:e.id,value:e.id},e.name)}))),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(T.a,{style:{width:"100%"},searchPlaceholder:"\u8bf7\u9009\u62e9",multiple:!0,showSearch:!1,treeData:a,value:n,treeCheckable:!0,onChange:this.handlePermOnChange})),u.a.createElement(N.a.Item,W,u.a.createElement(b.a,{block:!0,type:"primary",onClick:this.handleSubmit},"\u63d0\u4ea4")))))}}]),t}(u.a.Component),q=Object(f.g)(U),V={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},W={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},$=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,V,e("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},e("username",{rules:[{required:!0,type:"string",pattern:/^[a-zA-Z][a-zA-Z0-9_]{2,11}$/,message:"\u7528\u6237\u540d\u4e3a3~12\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf,\u7b2c\u4e00\u4f4d\u5fc5\u987b\u4e3a\u5b57\u6bcd"},{message:"\u7528\u6237\u540d\u5df2\u5b58\u5728",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,a,n,r,l){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,B.get("/user/check-unique-username?username=".concat(a)).then(function(e){if("00000000"===e.data.status){var t=!0===e.data.data||void 0;n(t)}else A.a.error(e.data.message),n()}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38"),n()});case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"password",label:"\u5bc6\u7801"},e("password",{rules:[{required:!1,message:"\u5bc6\u7801\u4e3a4~16\u4f4d\u4efb\u610f\u5b57\u7b26",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u9ed8\u8ba4\u5bc6\u7801\u4e3a1234"}))),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},e("phone",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",max:11}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},e("email",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1",type:"email"}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),e("dept"),e("permissions"))}}]),t}(u.a.Component),G=N.a.create({name:"normal_login"})($),Z=h.a.Content,J=F.a.Option,X=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Be,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=Object(y.a)({},t,{dept:{id:t.dept}});B.post("/user",n).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(Be,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.handlePermOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({permissions:e.map(function(e){return{id:e}})}),a.setState({permissions:e})},a.handleDeptOnChange=function(e){a.form&&a.form.props.form.setFieldsValue({dept:e}),a.setState({dept:e})},a.state={id:a.props.match.params.id,loading:!0,treeData:[],permissions:[],deptData:[],dept:""},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.state.id;this.setState({loading:!0},function(){B.get("/user?id=".concat(t)).then(function(t){var a=t.data.data,n=a.dept?a.dept.id:void 0;e.form&&e.form.props.form.setFieldsValue(Object(y.a)({},a,{dept:n}));var r=a.permissions.map(function(e){return e.id});e.setState({loading:!1,permissions:r,dept:n})}).catch(function(t){e.setState({loading:!1})}),B.get("/perm/all").then(function(t){var a=t.data.data.map(function(e,t){return{key:t,title:e.group,value:void 0,children:e.permissions.map(function(e){return{key:e.id,title:e.name,value:e.id}})}});e.setState({treeData:a})}).catch(function(e){}),B.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})})}},{key:"render",value:function(){var e=this,t=this.state,a=t.loading,n=t.treeData,r=t.permissions,l=t.deptData,o=t.dept;return u.a.createElement(Z,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{order:2,flexGrow:1,padding:"0 8px 0 0"}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{block:!0,type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},u.a.createElement(ne,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,ee,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",value:o,showSearch:!0,allowClear:!0,optionFilterProp:"children",filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0},onChange:this.handleDeptOnChange},l.map(function(e){return u.a.createElement(J,{key:e.id,value:e.id},e.name)}))),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(T.a,{style:{width:"100%"},searchPlaceholder:"\u8bf7\u9009\u62e9",multiple:!0,treeData:n,value:r,treeCheckable:!0,onChange:this.handlePermOnChange})),u.a.createElement(N.a.Item,te,u.a.createElement(b.a,{block:!0,type:"primary",loading:a,onClick:this.handleSubmit},"\u4fdd\u5b58")))))}}]),t}(u.a.Component),Q=Object(f.g)(X),ee={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},te={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},ae=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue;return u.a.createElement(N.a,ee,t("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},t("username",{rules:[{required:!0,type:"string",pattern:/^[a-zA-Z][a-zA-Z0-9_]{2,11}$/,message:"\u7528\u6237\u540d\u4e3a3~12\u4f4d\u5b57\u6bcd\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf,\u7b2c\u4e00\u4f4d\u5fc5\u987b\u4e3a\u5b57\u6bcd"},{message:"\u7528\u6237\u540d\u5df2\u5b58\u5728",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,n,r,l,o){var c;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=a("id"),e.next=3,B.get("/user/check-unique-username?username=".concat(n,"&id=").concat(c)).then(function(e){if("00000000"===e.data.status){var t=!0===e.data.data||void 0;r(t)}else A.a.error(e.data.message),r()}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38"),r()});case 3:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},t("phone",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",max:11}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},t("email",{rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1",type:"email"}],validateTrigger:"onBlur"})(u.a.createElement(I.a,null))),t("dept"),t("permissions"))}}]),t}(u.a.Component),ne=N.a.create({name:"normal_login"})(ae),re=(a(115),a(60)),le=(a(156),a(91)),oe=(a(125),a(55)),ce=(a(151),a(61)),ie=(a(284),a(142)),se=a(21),ue=a.n(se),de=a(187),me=a.n(de);function pe(e){return e.replace(/([A-Z])/g,"_$1").toLowerCase()}function fe(){var e=me()("section.ant-layout");if(3===e.length)return e[2]}function he(e,t){var a=fe();a&&a.addEventListener("scroll",function(e,t,a){var n=a.target.offsetTop,r=a.target.scrollTop;r>=2*n/3?e():r<2*n/3&&t()}.bind(a,e,t))}function ye(){var e=fe();e&&e.removeEventListener("scroll",function(){})}var ge=h.a.Content,ve=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleListChange=function(){var e=a.props.httpPath;a.setState({loading:!0},function(){var t=a.state,n=t.pageSize,r=t.current,l=t.param,o=Object(y.a)({pageSize:n,current:r},l);B.post("".concat(e,"/list"),o).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChange=function(e){a.state.param.conditions.keywords=e,a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.props.httpPath,ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e="";t.forEach(function(t){return e=e.concat("ids=".concat(t,"&"))}),B.delete("".concat(n,"?").concat(e.substring(0,e.length-1))).then(function(e){"00000000"===e.data.status?(A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)})}});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleOk=function(e){e.preventDefault();var t=a.props.httpPath,n=a.state.modalFlag;a.form&&a.form.props.form.validateFields(function(e,r){if(!e){var l=1===n?B.put:2===n?B.post:void 0;l&&l("".concat(t),r).then(function(e){"00000000"===e.data.status?(A.a.success("\u64cd\u4f5c\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.msg)}),a.setState({modalFlag:0})}})},a.handleCancel=function(e){a.setState({modalFlag:0,modalData:void 0})},a.state={loading:!0,selectedRowKeys:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{},sorters:{}},modalFlag:0,modalData:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleListChange()}},{key:"renderSearchBar",value:function(){var e=this.props.modelName;return u.a.createElement(F.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165".concat(e),style:{width:"280px"},tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(v.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChange,notFoundContent:null})}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement("div",null,u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault(),e.setState({modalFlag:1})}},"\u65b0\u5efa"),u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664"))}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u540d\u79f0",key:"name",dataIndex:"name",onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",key:"createTime",dataIndex:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.setState({modalFlag:2,modalData:a})}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.handleDeleteOper([a.id])}},"\u5220\u9664"))},onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.selectedRowKeys,r=t.data,l=t.pageSize,o=t.current,c=r.total,i=r.content;return a||r.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:{columnWidth:"30px",selectedRowKeys:n,onChange:function(t){e.setState({selectedRowKeys:t})}},columns:this.buildColumns(),dataSource:i,loading:a,pagination:{total:c,current:o,pageSize:l,pageSizeOptions:["10","20","50"],showSizeChanger:!0,showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[pe(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})}},{key:"renderAddModal",value:function(){var e=this,t=this.state,a=t.modalFlag,n=t.modalData,r="".concat(1===a?"\u65b0\u5efa":2===a?"\u7f16\u8f91":void 0,"\u79d1\u5ba4");return u.a.createElement(ce.a,{title:r,visible:a>0,okText:"\u63d0\u4ea4",cancelText:"\u53d6\u6d88",onOk:this.handleOk,onCancel:this.handleCancel},u.a.createElement(Ce,{wrappedComponentRef:function(t){e.form=t,e.form&&(2===a&&n?e.form.props.form.setFieldsValue(Object(y.a)({},n)):1===a&&e.form.props.form.resetFields(["id","name"]))}}))}},{key:"render",value:function(){return u.a.createElement(ge,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))),u.a.createElement("div",null,this.renderAddModal()))}}]),t}(u.a.Component);var Ee=Object(f.g)(ve),be={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},ke=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,be,e("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"name",label:"\u540d\u79f0"},e("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u540d\u79f0"}]})(u.a.createElement(I.a,null))))}}]),t}(u.a.Component),Ce=N.a.create({name:"normal_login"})(ke),Oe=(a(552),h.a.Content),we=F.a.Option,xe=ie.a.TabPane,je=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);B.post("/user/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadDeptData=function(){a.setState({loading:!0},function(){B.post("/dept/list-all").then(function(e){a.setState({loading:!1,deptData:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChangeForKeyword=function(e){a.state.param.conditions.keywords=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForDept=function(e){a.state.param.conditions.dept={id:e},a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e="";t.forEach(function(t){return e=e.concat("ids=".concat(t,"&"))}),B.delete("/user?".concat(e.substring(0,e.length-1))).then(function(e){"00000000"===e.data.status?(A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange()):A.a.error(e.data.message)})}});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={loading:!0,deptData:[],selectedRowKeys:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{},sorters:{}}},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.loadDeptData(),this.handleListChange()}},{key:"renderKeywordSearchBar",value:function(){return u.a.createElement(F.a,{mode:"tags",placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u3001\u624b\u673a\u53f7\u6216\u90ae\u7bb1",style:{width:"280px",marginRight:"24px"},tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(v.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChangeForKeyword,notFoundContent:null})}},{key:"renderDeptSearchBar",value:function(){var e=this.state.deptData;return u.a.createElement("span",null,u.a.createElement("label",null,"\u6240\u5c5e\u79d1\u5ba4\uff1a"),u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"280px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForDept},e.map(function(e){return u.a.createElement(we,{key:e.id,value:e.id},e.name)})))}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement("div",null,u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(Be,"/add"))}},"\u65b0\u5efa"),u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664"))}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u7528\u6237\u540d",dataIndex:"username",key:"username",onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u624b\u673a",dataIndex:"phone",key:"phone",onHeaderCell:function(e){return{style:{textAlign:"center",width:"12%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u90ae\u7bb1",dataIndex:"email",key:"email",onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u79d1\u5ba4",dataIndex:"dept",key:"dept",onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e?e.name:""},e?e.name:"")}},{title:"\u51bb\u7ed3\u72b6\u6001",dataIndex:"frozen",key:"frozen",render:function(e,t,a){return t.frozen?u.a.createElement("span",{className:"warn-text"},"\u5df2\u51bb\u7ed3"):u.a.createElement("span",{className:"success-text"},"\u6b63\u5e38")},onHeaderCell:function(e){return{style:{textAlign:"center",width:"8%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(Be,"/edit/").concat(a.id))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault();var n=a.frozen?"unfreeze":"freeze";B.post("/user/".concat(n),{ids:[a.id]}).then(function(t){A.a.success("".concat(a.frozen?"\u89e3\u51bb":"\u51bb\u7ed3","\u6210\u529f")),e.handleListChange()}).catch(function(t){e.handleListChange()})}},a.frozen?"\u89e3\u51bb":"\u51bb\u7ed3"),u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.handleDeleteOper([a.id])}},"\u5220\u9664"))},onHeaderCell:function(e){return{style:{textAlign:"center",width:"18%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.selectedRowKeys,r=t.data,l=t.pageSize,o=t.current,c=r.total,i=r.content;return a||r.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:{columnWidth:"30px",selectedRowKeys:n,onChange:function(t){e.setState({selectedRowKeys:t})}},columns:this.buildColumns(),dataSource:i,loading:a,onRow:function(t,a){return{onClick:function(a){a.preventDefault(),"TD"===a.target.tagName&&e.props.history.push("".concat(Be,"/view/").concat(t.id))}}},pagination:{total:c,current:o,pageSize:l,pageSizeOptions:["10","20","50"],showSizeChanger:!0,showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[pe(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})}},{key:"render",value:function(){return u.a.createElement(Oe,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement(ie.a,{defaultActiveKey:"account",onChange:function(){}},u.a.createElement(xe,{tab:"\u79d1\u5ba4",key:"dept"},u.a.createElement(Ee,{httpPath:"/dept",modelName:"\u79d1\u5ba4"})),u.a.createElement(xe,{tab:"\u8d26\u53f7",key:"account"},u.a.createElement("div",{className:"list-page-content-toolbar"},u.a.createElement("div",{className:"list-page-content-toolbar-search"},this.renderKeywordSearchBar(),this.renderDeptSearchBar()),u.a.createElement("div",{className:"list-page-content-toolbar-button"},this.renderButtonBar())),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))))}}]),t}(u.a.Component);var Se=Object(f.g)(je),De=(a(131),a(65)),Ie=(a(554),a(235)),Te=h.a.Content,Ne=Ie.a.TreeNode,Ae={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},Fe=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(Be,"/list"))},a.state={loading:!0,data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0},function(){B.get("/user?id=".concat(t)).then(function(t){var a=t.data.data;e.setState({loading:!1,data:a})}).catch(function(e){})})}},{key:"renderContent",value:function(){var e=this.state,t=e.loading,a=e.data;return!t&&a?u.a.createElement(N.a,Ae,u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},a.username),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},a.phone),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},a.email),u.a.createElement(N.a.Item,{key:"dept",label:"\u79d1\u5ba4"},a.dept&&a.dept.name),u.a.createElement(N.a.Item,{key:"permissions",label:"\u8d26\u53f7\u6388\u6743"},u.a.createElement(Ie.a,{showLine:!0,defaultExpandAll:!0},a.permissions.map(function(e){return u.a.createElement(Ne,{title:e.name})})))):u.a.createElement(De.a,{size:"large"})}},{key:"render",value:function(){var e=this,t=this.props.match.params.id;return u.a.createElement(Te,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(a){a.preventDefault(),e.props.history.push("".concat(Be,"/edit/").concat(t))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent()))}}]),t}(u.a.Component),Me=Object(f.g)(Fe),Pe=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.location.pathname;return a.indexOf("".concat(Be,"/add"))>=0?e="\u65b0\u589e":a.indexOf("".concat(Be,"/edit"))>=0?e="\u7f16\u8f91":a.indexOf("".concat(Be,"/view"))>=0?e="\u8be6\u60c5":a.indexOf("".concat(Be,"/list"))>=0&&(e="\u67e5\u8be2"),u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,null,u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u8d26\u53f7\u4e0e\u5b89\u5168"),u.a.createElement(x.a.Item,{onClick:function(){return t.props.history.push("".concat(Be))}},"\u8d26\u53f7\u7ba1\u7406"),u.a.createElement(x.a.Item,null,e)),u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"".concat(Be),exact:!0,to:"".concat(Be,"/list")}),u.a.createElement(f.b,{path:"".concat(Be,"/list"),component:Se}),u.a.createElement(f.b,{path:"".concat(Be,"/add"),component:q}),u.a.createElement(f.b,{path:"".concat(Be,"/edit/:id"),component:Q}),u.a.createElement(f.b,{path:"".concat(Be,"/view/:id"),component:Me})))))}}]),t}(u.a.Component),Le=Object(f.g)(Pe),Ye=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-aside"}),u.a.createElement("div",{className:"layout-content-inner"}))}}]),t}(u.a.Component),ze="/main/user",Be="".concat(ze,"/manage"),Re=("".concat(ze,"/authority"),h.a.Sider),Ke=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,selectedKeys:[]},a.handleOnSelect=function(e){var t=e.key;a.setState({selectedKeys:[t]}),a.props.history.push("".concat(ze).concat(t))},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleOnSelect({key:"/manage"})}},{key:"render",value:function(){var e=this.state.selectedKeys;return u.a.createElement(h.a,null,u.a.createElement(Re,{width:180,theme:"dark",collapsed:this.state.collapsed,collapsedWidth:80},u.a.createElement("span",{className:"aside-top",onClick:this.toggleCollapsed},u.a.createElement(v.a,{style:{margin:"0 0 0 10px"},type:this.state.collapsed?"menu-unfold":"menu-fold"})),u.a.createElement(E.b,{selectedKeys:e,mode:"inline",theme:"dark",onSelect:this.handleOnSelect},u.a.createElement(E.b.Item,{className:"aside-item",key:"/manage"},u.a.createElement(v.a,{type:"solution"}),u.a.createElement("span",null,"\u8d26\u53f7\u7ba1\u7406")),u.a.createElement(E.b.Item,{className:"aside-item",key:"/authority"},u.a.createElement(v.a,{type:"safety-certificate"}),u.a.createElement("span",null,"\u6388\u6743\u67e5\u8be2")))),u.a.createElement(h.a,null,u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.b,{path:"".concat(ze,"/manage"),component:Le}),u.a.createElement(f.b,{path:"".concat(ze,"/authority"),component:Ye})))))}}]),t}(u.a.Component),He=Object(f.g)(Ke),_e=(a(556),a(332)),Ue=a(191),qe=function(e){var t=e.component,a=Object(Ue.a)(e,["component"]);return u.a.createElement(wa.Consumer,null,function(e){var n=a.permission,r=e.permissions,l=n?r.find(function(e){return n instanceof Array?n.find(function(t){return e.id===t}):e.id===n}):"true";return u.a.createElement(f.b,Object.assign({},a,{render:function(e){return sessionStorage.getItem("userId")?l?u.a.createElement(t,null):u.a.createElement(_e.a,{style:{width:"100%",height:"100%"},status:"403",title:"403",subTitle:"\u6ca1\u6709\u8bbf\u95ee\u6743\u9650"}):u.a.createElement(f.a,{to:{pathname:"/login",state:{from:e.location.pathname}}})}}))})},Ve=(a(153),a(38)),We=(a(154),a(25)),$e=a(90),Ge=a.n($e),Ze=F.a.Option,Je=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).fetchUser=function(e){if(e&&""!==e.trim()){var t={contractNum:e};a.setState({data:[],loading:!0}),setTimeout(function(){B.post("/docm/contract-num/list",t).then(function(e){var t=[];"00000000"===e.data.status&&e.data.data.length>0&&(t=e.data.data.map(function(e){return{text:e,value:e}})),a.setState({data:t,loading:!1})})},300)}},a.handleChange=function(e){var t=a.props.onChange;a.setState({value:e,data:[],loading:!1}),t&&t(e)},a.fetchUser=Ge()(a.fetchUser,800),a.state={param:{conditions:{ranges:{}},sorters:{}},data:[],value:[],loading:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.data,n=e.value;return u.a.createElement(F.a,{value:n,placeholder:"\u4e2d\u6807\u7f16\u53f7",notFoundContent:t?u.a.createElement(De.a,{size:"small"}):null,filterOption:!1,showSearch:!0,onSearch:this.fetchUser,onChange:this.handleChange,showArrow:!1,allowClear:!0},a.map(function(e,t){return u.a.createElement(Ze,{key:"".concat(e.value,"-").concat(t),value:e.value},e.text)}))}}]),t}(u.a.Component),Xe=(a(558),h.a.Content),Qe=F.a.Option,et={xs:{span:6},md:{span:6}},tt={labelCol:{xs:{span:5},md:{span:5}},wrapperCol:{xs:{span:19},md:{span:19}}},at=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);B.post("/docm/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadProjectTypes=function(){B.get("/docm/type/list").then(function(e){a.setState({projectTypes:e.data.data})}).catch(function(e){A.a.error("\u52a0\u8f7d\u9879\u76ee\u7c7b\u578b\u6570\u636e\u5931\u8d25")})},a.loadDeptData=function(){a.setState({loading:!0},function(){B.post("/dept/list-all").then(function(e){a.setState({loading:!1,deptData:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.handleSelectChange=function(e,t){a.state.param.conditions[e]=t,a.setState({current:1}),a.handleListChange()},a.handleCheckInvalidAttach=Object(D.a)(S.a.mark(function e(){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B.get("/doc/check-invalid-attach").then(function(e){a.setState({loading:!1,invalidAttachInfos:e.data,visible:!0})}).catch(function(e){a.setState({loading:!1})});case 1:case"end":return e.stop()}},e)})),a.handleDeleteInvalidAttach=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:B.post("/doc/delete-invalid-attach",t).then(function(e){A.a.success("\u64cd\u4f5c\u6210\u529f"),a.setState({loading:!1,invalidAttachInfos:[],visible:!1})}).catch(function(e){a.setState({loading:!1})});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(S.a.mark(function e(){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",t.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),e.next=4,B.delete("/docm?".concat(n.substring(0,n.length-1)));case 4:A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange();case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.state={loading:!0,needFixed:!1,selectedRowKeys:[],projectTypes:[],data:{total:void 0,content:[]},pageSize:15,current:1,param:{conditions:{},sorters:{}},deptData:[],visible:!1,invalidAttachInfos:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.loadProjectTypes(),this.loadDeptData(),this.handleListChange(),he(function(){return e.setState({needFixed:!0})},function(){return e.setState({needFixed:!1})})}},{key:"componentWillUnmount",value:function(){ye()}},{key:"buildColumns",value:function(){var e=this;return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u5408\u540c\u540d\u79f0",dataIndex:"projectName",key:"projectName",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u5408\u540c\u7c7b\u578b",dataIndex:"projectType",key:"projectType",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u4e59\u65b9\u540d\u79f0",dataIndex:"company",key:"company",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u4e2d\u6807\u7f16\u53f7",dataIndex:"contractNum",key:"contractNum",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},{title:"\u79d1\u5ba4",dataIndex:"dept",key:"dept",onHeaderCell:function(e){return{style:{textAlign:"center",width:"6%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e?e.name:""},e?e.name:"")}},{title:"\u603b\u91d1\u989d",dataIndex:"money",key:"money",sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"15%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id},onHeaderCell:function(e){return{style:{textAlign:"center",width:"12%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},{title:"\u64cd\u4f5c",key:"operation",render:function(t,a,n){return u.a.createElement(wa.Consumer,null,function(t){var n=t.permissions.find(function(e){return"DOCM_EDIT_OPER"===e.id}),r=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id}),l=t.permissions.find(function(e){return"DOCM_DOWNLOAD_OPER"===e.id});return u.a.createElement("div",null,n&&u.a.createElement(b.a,{type:"link",onClick:function(t){t.preventDefault(),e.props.history.push("".concat(zt,"/edit/").concat(a.id))}},"\u7f16\u8f91"),l&&a.attachments&&a.attachments.length>0&&u.a.createElement(b.a,{type:"link",href:"".concat(Y,"/doc?id=").concat(a.id,"&xAuthToken=").concat(sessionStorage.getItem("xAuthToken")),target:"_blank"},"\u4e0b\u8f7d"),r&&u.a.createElement(b.a,{type:"link",onClick:function(){return e.handleDeleteOper([a.id])}},"\u5220\u9664"))})},onHeaderCell:function(e){return{style:{textAlign:"center",width:"16%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}}]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.pageSize,l=t.current,o=t.selectedRowKeys,c=t.visible,i=t.invalidAttachInfos;return u.a.createElement(wa.Consumer,null,function(t){var s=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id})?{columnWidth:"30px",selectedRowKeys:o,onChange:function(t){e.setState({selectedRowKeys:t})}}:void 0;return!a&&n&&n.content.length>0?u.a.createElement(u.a.Fragment,null,u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:s,columns:e.buildColumns(),dataSource:n.content,loading:a,onRow:function(t,a){return{onClick:function(a){"TD"===a.target.tagName&&e.props.history.push("".concat(zt,"/view/").concat(t.id))}}},size:"small",pagination:{total:n.total,current:l,pageSize:r,pageSizeOptions:["15","30","50"],showSizeChanger:!0,onShowSizeChange:function(t,a){e.setState({current:1,pageSize:a})},showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[pe(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}),i&&i.length>0?u.a.createElement(ce.a,{visible:c,title:"\u4e0d\u5b58\u5728\u7684\u6587\u4ef6",onOk:function(e){A.a.info("OK")},onCancel:function(t){e.setState({visible:!1})},footer:[u.a.createElement(b.a,{key:"delete",loading:a,type:"primary",onClick:function(){return e.handleDeleteInvalidAttach(i)}},"\u6e05\u7406"),u.a.createElement(b.a,{key:"cancel",loading:a,onClick:function(){e.setState({visible:!1})}},"\u53d6\u6d88")],width:1e3},i.map(function(e){return u.a.createElement("p",null,e.path)})):c&&e.handleNotFoundInvalidAttachs()):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})})}},{key:"handleNotFoundInvalidAttachs",value:function(){A.a.success("\u6240\u6709\u9644\u4ef6\u6b63\u5e38"),this.setState({visible:!1})}},{key:"renderKeywordSearchBar",value:function(){return u.a.createElement(F.a,{mode:"tags",placeholder:"\u5408\u540c\u540d\u79f0\u3001\u4e59\u65b9\u540d\u79f0\u6216\u91d1\u989d",tokenSeparators:[" "],showArrow:!0,suffixIcon:u.a.createElement(v.a,{style:{fontSize:"16px"},type:"search"}),onChange:this.handleSelectChange.bind(this,"keywords"),notFoundContent:null})}},{key:"renderProjectTypeSearchBar",value:function(){var e=this.state.projectTypes;return u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9\u5408\u540c\u7c7b\u578b",allowClear:!0,showArrow:!0,onChange:this.handleSelectChange.bind(this,"projectType"),notFoundContent:"\u6682\u65e0\u6570\u636e"},e.map(function(e){return u.a.createElement(Qe,{key:e,value:e},e)}))}},{key:"renderDeptSearchBar",value:function(){var e=this.state.deptData;return u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",allowClear:!0,showArrow:!0,onChange:this.handleSelectChange.bind(this,"dept")},e.map(function(e){return u.a.createElement(Qe,{key:e.id,value:e.id},e.name)}))}},{key:"renderContractNumSearchBar",value:function(){return u.a.createElement(Je,{onChange:this.handleSelectChange.bind(this,"contractNum")})}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement(wa.Consumer,null,function(a){var n=a.permissions.find(function(e){return"DOCM_ADD_OPER"===e.id}),r=a.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id});return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},r&&u.a.createElement(b.a,{className:"ele-operation",type:"ghost",onClick:function(){e.handleCheckInvalidAttach()}},"\u68c0\u67e5\u9644\u4ef6"),n&&u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(){e.props.history.push("".concat(zt,"/add"))}},"\u65b0\u5efa"),r&&u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664")))})}},{key:"renderToolBar",value:function(){return u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{flex:"1"}},u.a.createElement(N.a,tt,u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,et,u.a.createElement(N.a.Item,{key:"renderKeywordSearchBar",label:"\u5173\u952e\u5b57"},this.renderKeywordSearchBar())),u.a.createElement(We.a,et,u.a.createElement(N.a.Item,{key:"renderProjectTypeSearchBar",label:"\u5408\u540c\u7c7b\u578b"},this.renderProjectTypeSearchBar())),u.a.createElement(We.a,et,u.a.createElement(N.a.Item,{key:"renderDeptSearchBar",label:"\u79d1\u5ba4"},this.renderDeptSearchBar())),u.a.createElement(We.a,et,u.a.createElement(N.a.Item,{key:"renderContractNumSearchBar",label:"\u4e2d\u6807\u7f16\u53f7"},this.renderContractNumSearchBar()))))),u.a.createElement("div",{style:{flex:".2"}},this.renderButtonBar())))}},{key:"render",value:function(){var e=this.state.needFixed;return u.a.createElement(Xe,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar ".concat(e?"toolbar-fixed":"")},this.renderToolBar()),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))}}]),t}(u.a.Component);var nt=Object(f.g)(at),rt=(a(559),a(325)),lt=(a(293),a(190)),ot=(a(562),a(237)),ct=(a(564),a(329)),it=a(333),st={xs:{span:24},md:{span:12}},ut={labelCol:{xs:{span:6},md:{span:4}},wrapperCol:{xs:{span:12},md:{span:18}}},dt={labelCol:{xs:{span:6},md:{span:2}},wrapperCol:{xs:{span:12},md:{span:21}}},mt={onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}},render:function(e){return e&&u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}},pt=(a(310),a(159)),ft=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).onChange=function(e){var t=e.target.value,n=a.props.onChange;(!Number.isNaN(t)&&/^-?(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(t)||""===t||"-"===t)&&n&&n(t)},a.onBlur=function(){var e=a.props,t=e.value,n=e.onBlur,r=e.onChange;!t||"."!==t.charAt(t.length-1)&&"-"!==t||r&&r({value:t.slice(0,-1)}),n&&n()},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(I.a,Object.assign({},this.props,{onChange:this.onChange,onBlur:this.onBlur,maxLength:25}))}}]),t}(u.a.Component),ht=F.a.Option,yt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={value:e.value?e.value.id:void 0,deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;B.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})}},{key:"handleOnChange",value:function(e){var t=this.props.onChange,a=this.state.deptData.find(function(t){return t.id===e});t&&t(a),this.setState({value:e})}},{key:"render",value:function(){var e=this.state,t=e.deptData,a=e.value;return u.a.createElement(F.a,{style:{width:"100%"},placeholder:"\u8bf7\u9009\u62e9",value:a,showSearch:!0,allowClear:!0,onChange:this.handleOnChange.bind(this),filterOption:function(e,t){return t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}},t.map(function(e){return u.a.createElement(ht,{key:e.id,value:e.id},e.name)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){if(e.value){if(!t.value)return{value:e.value.id};if(e.value.id!==t.value.id)return{value:e.value.id}}return null}}]),t}(u.a.Component),gt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).state={deptData:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return e("id"),e("attachments"),u.a.createElement(N.a,ut,u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"projectName",label:"\u5408\u540c\u540d\u79f0"},e("projectName",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5408\u540c\u540d\u79f0"},{max:100,message:"\u4e0d\u80fd\u8d85\u8fc7100\u5b57"}]})(u.a.createElement(I.a,null)))),u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},e("dept")(u.a.createElement(yt,null))))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"company",label:"\u4e59\u65b9\u540d\u79f0"},e("company",{rules:[{max:100,message:"\u4e0d\u80fd\u8d85\u8fc7100\u5b57"}]})(u.a.createElement(I.a,null)))),u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"projectType",label:"\u5408\u540c\u7c7b\u578b"},e("projectType",{rules:[{max:50,message:"\u4e0d\u80fd\u8d85\u8fc750\u5b57"}]})(u.a.createElement(I.a,null))))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u4e2d\u6807\u7f16\u53f7"},e("contractNum",{rules:[{max:50,message:"\u4e0d\u80fd\u8d85\u8fc750\u5b57"}]})(u.a.createElement(I.a,null)))),u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"contractTime",label:"\u5408\u540c\u7b7e\u8ba2\u65f6\u95f4"},e("contractTime")(u.a.createElement(pt.a,{style:{width:"100%"},format:"YYYY-MM-DD"}))))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"money",label:"\u603b\u91d1\u989d"},e("money",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u5408\u540c\u603b\u91d1\u989d"}]})(u.a.createElement(ft,{onChange:function(e){},tips:"\u8bf7\u8f93\u5165\u5408\u540c\u603b\u91d1\u989d"})))),u.a.createElement(We.a,st,u.a.createElement(N.a.Item,{key:"desc",label:"\u5907\u6ce8"},e("desc",{rules:[{max:500,message:"\u4e0d\u80fd\u8d85\u8fc7500\u5b57"}]})(u.a.createElement(I.a.TextArea,null))))))}}]),t}(s.Component),vt=N.a.create()(gt),Et=(a(569),h.a.Content),bt=ct.a.Dragger,kt=ot.a.Meta,Ct=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).editForm=void 0,a.handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(zt,"/list"))},a.handleSubmit=function(e){e.preventDefault(),a.editForm&&a.editForm.props.form.validateFields(function(e,t){if(!e){var n=a.state.fileList,r=Object(y.a)({},t,{contractTime:t.contractTime?t.contractTime.format("YYYY-MM-DD"):void 0,credentialTime:t.credentialTime?t.credentialTime.format("YYYY-MM"):void 0,attachments:n.filter(function(e){return"done"===e.status}).map(function(e){return{docPath:e.docPath,docName:e.docName,type:e.type,size:e.size,md5:e.md5}})}),l=a.state.mode,o="add"===l?B.put:"edit"===l?B.post:void 0;o&&o("/docm",r).then(function(e){"00000000"===e.data.status?a.props.history.push("".concat(zt,"/list")):A.a.error(e.data.message)}).catch(function(e){A.a.info(e.response.data.msg)})}})},a.updateFileUploadByResponse=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&Object.assign(r,t),a.setState({fileList:n})},a.updateFileUploadStatus=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&(r.status=t),a.setState({fileList:n})},a.updateFileUploadProgress=function(e,t){var n=a.state.fileList,r=n.find(function(t){return t.uid===e});r&&(r.percent=t),a.setState({fileList:n})},a.addFileUpload=function(e){var t=a.state.fileList;t=t.concat({uid:e.uid,size:e.size,name:e.name,type:e.type,status:"uploading",docName:"",docPath:"",md5:""}),a.setState({fileList:t})},a.handleCustomUpload=function(e){var t=e.file,n=t.name;if(/.+(\.pdf)|(\.docx)|(\.xlsx)|(\.jpg)|(\.png)$/.test(n)){a.addFileUpload(t);var r=new FormData;r.append("files",t),me.a.ajax({url:"".concat(Y,"/doc?xAuthToken=").concat(sessionStorage.getItem("xAuthToken")),type:"POST",data:r,dataType:"json",processData:!1,contentType:!1,timeout:6e4,xhr:function(){var e=new XMLHttpRequest;return e.upload&&e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var n=Math.floor(e.loaded/e.total*100);a.updateFileUploadProgress(t.uid,n)}},!1),e},success:function(e){var n=e.data[0],r=(n.name,Object(Ue.a)(n,["name"]));"00000000"===e.status&&e.data&&a.updateFileUploadByResponse(t.uid,r),setTimeout(function(){a.updateFileUploadStatus(t.uid,"done")},1500)},error:function(e){403===e.status?A.a.error("\u60a8\u6ca1\u6709\u4e0a\u4f20\u6743\u9650"):A.a.error("".concat(t.name," \u4e0a\u4f20\u5931\u8d25"))}})}else A.a.error("\u4e0d\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b")},a.renderForm=function(){var e=a.state,t=e.fileList,n=e.appConf.uploadFileMaxAmount;return u.a.createElement("div",null,u.a.createElement(vt,{wrappedComponentRef:function(e){return a.editForm=e}}),u.a.createElement(N.a,ut,u.a.createElement(N.a.Item,Object.assign({},dt,{key:"upload",label:"\u9644\u4ef6"}),t.length>=n?null:u.a.createElement(bt,{accept:".pdf,.docx,.xlsx,.jpg,.png",name:"files",multiple:!0,showUploadList:!1,customRequest:a.handleCustomUpload},u.a.createElement("p",{className:"ant-upload-drag-icon"},u.a.createElement(v.a,{type:"inbox"})),u.a.createElement("p",{className:"ant-upload-text"},"\u70b9\u51fb\u6216\u62d6\u62fd\u6587\u4ef6\u5230\u6b64\u533a\u57df\u4e0a\u4f20"),u.a.createElement("p",{className:"ant-upload-hint"},"\u652f\u6301\u7684\u6587\u4ef6\u7c7b\u578b\u4e3apdf\u3001docx\u3001xlsx\u3001jpg\u548cpng\uff0c\u4e14\u6700\u591a20\u4e2a\u9644\u4ef6")),a.showAttachmentList())))},a.state={mode:void 0,appConf:{uploadFileMaxAmount:20},loading:!0,data:void 0,fileList:[],deptData:[],selectedDept:void 0,percent:0,needFixed:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.initData(),he(function(){e.setState({needFixed:!0})},function(){e.setState({needFixed:!1})})}},{key:"componentWillUnmount",value:function(){ye()}},{key:"initData",value:function(){var e=this,t=this.props.match.params.id,a=t?"edit":"add";this.setState({mode:a,loading:!0},function(){"edit"===a?B.get("/docm?id=".concat(t)).then(function(t){var a=t.data.data;e.editForm&&e.editForm.props.form.setFieldsValue(Object(y.a)({},a,{contractTime:a.contractTime?ue()(a.contractTime,"YYYY-MM-DD"):void 0,credentialTime:a.credentialTime?ue()(a.credentialTime,"YYYY-MM"):void 0}));var n=a.attachments.map(function(e){return{uid:e.id,name:e.docName,docName:e.docName,docPath:e.docPath,type:e.type,size:e.size,status:"done"}});e.setState({loading:!1,data:a,fileList:n,selectedDept:a.dept})}).catch(function(e){}):"add"===a&&(e.editForm&&e.editForm.props.form.setFieldsValue({attachments:[]}),e.setState({loading:!1})),B.post("/dept/list-all").then(function(t){e.setState({deptData:t.data.data})}).catch(function(e){})})}},{key:"showAttachmentList",value:function(){var e=this;return this.state.fileList.map(function(t){return u.a.createElement(ot.a,{key:t.uid,size:"small",style:{marginTop:"8px"}},u.a.createElement(kt,{title:u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex"}},u.a.createElement("p",{style:{flexGrow:1,overflow:"hidden",width:"200px"}},t.name),u.a.createElement("div",{style:{flexGrow:.1}},u.a.createElement(b.a,{type:"link",style:{float:"right",color:"gray"},onClick:function(){for(var a=e.state.fileList,n=a.length,r=0;r<n;r++)if(a[r].uid===t.uid){a.splice(r,1);break}e.setState({fileList:a})}},u.a.createElement(v.a,{type:"delete"})))),u.a.createElement("div",{style:{color:"gray"}},"".concat(t.size," Byte")),"done"!==t.status&&u.a.createElement(lt.a,{percent:t.percent})),avatar:u.a.createElement(rt.a,{shape:"square",size:"large",icon:"file"})}))})}},{key:"render",value:function(){var e=this.state.mode;return u.a.createElement(Et,null,u.a.createElement("div",{className:"tool-bar ".concat(this.state.needFixed?"toolbar-fixed":"")},u.a.createElement("div",{className:"tool-bar-item"}),u.a.createElement("div",{className:"tool-bar-item"}),u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement("div",{className:"tool-bar",style:{float:"right"}},u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement(b.a,{block:!0,type:"primary",onClick:this.handleSubmit},"add"===e?"\u63d0\u4ea4":"\u4fdd\u5b58")),u.a.createElement("div",{className:"tool-bar-item"},u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de"))))),u.a.createElement("div",{style:{margin:"8px"}},this.renderForm()))}}]),t}(u.a.Component),Ot=Object(it.a)({name:"form"})(Ct),wt=Object(f.g)(Ot),xt=(a(608),a(331)),jt=pt.a.MonthPicker,St=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return e("id"),u.a.createElement(N.a,ut,u.a.createElement(N.a.Item,{key:"order",label:"\u5e8f\u53f7"},e("order",{rules:[{required:!0,message:"\u5e8f\u53f7\u4e0d\u80fd\u4e3a\u7a7a"}]})(u.a.createElement(xt.a,null))),u.a.createElement(N.a.Item,{key:"money",label:"\u91d1\u989d"},e("money",{rules:[{required:!0,message:"\u91d1\u989d\u4e0d\u80fd\u4e3a\u7a7a"}]})(u.a.createElement(ft,null))),u.a.createElement(N.a.Item,{key:"credentialNum",label:"\u51ed\u8bc1\u53f7"},e("credentialNum",{rules:[{max:50,message:"\u4e0d\u80fd\u8d85\u8fc750\u5b57\u7b26"}]})(u.a.createElement(I.a,null))),u.a.createElement(N.a.Item,{key:"credentialTime",label:"\u51ed\u8bc1\u65f6\u95f4"},e("credentialTime")(u.a.createElement(jt,{style:{width:"100%"},format:"YYYY-MM"}))),u.a.createElement(N.a.Item,{key:"payTime",label:"\u4ed8\u6b3e\u65f6\u95f4"},e("payTime")(u.a.createElement(pt.a,{style:{width:"100%"},format:"YYYY-MM-DD"}))),u.a.createElement(N.a.Item,{key:"desc",label:"\u5907\u6ce8"},e("desc",{rules:[{max:500,message:"\u4e0d\u80fd\u8d85\u8fc7500\u5b57"}]})(u.a.createElement(I.a.TextArea,null))))}}]),t}(s.Component),Dt=N.a.create()(St),It=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.state={data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.setValue()}},{key:"setValue",value:function(){var e=this.state.data;if(this.form){var t=this.form.props.form,a=t.setFieldsValue,n=t.resetFields;if(e){var r=e.id,l=e.order,o=e.money,c=e.credentialNum,i=e.credentialTime,s=e.payTime,u=e.desc;a({id:r,order:l,money:o,credentialNum:c,credentialTime:i?ue()(i,"YYYY-MM"):void 0,payTime:s?ue()(s,"YYYY-MM-DD"):void 0,desc:u})}else n()}}},{key:"render",value:function(){var e=this;return u.a.createElement(Dt,{wrappedComponentRef:function(t){e.form=t,e.props.wrappedComponentRef(t)}})}}],[{key:"getDerivedStateFromProps",value:function(e,t){return{data:e.data}}}]),t}(s.Component),Tt=(a(610),function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleClick=function(e){a.setState({loading:!0,disable:!0}),a.props.onClick(e);var t=a.props.url,n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onload=function(){if(200===n.status){var e=n.response,t=window.URL.createObjectURL(e);a.props.onLoad(t),a.setState({loading:!1,disable:!1})}else A.a.error(n.statusText)},n.send()},a.state={loading:!1,disable:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.text,a=e.icon,n=e.type,r=this.state,l=r.loading,o=r.disable;return u.a.createElement(b.a,{type:n,loading:l,disabled:o,icon:a,onClick:this.handleClick},l?"\u52a0\u8f7d\u4e2d":t)}}]),t}(u.a.Component)),Nt=a(160);Nt.pdfjs.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(Nt.pdfjs.version,"/pdf.worker.js");var At={cMapUrl:"cmaps/",cMapPacked:!0},Ft=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={numPages:null},a.onDocumentLoadSuccess=function(e){var t=e.numPages;a.setState({numPages:t})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.numPages,t=this.props.fileData;return u.a.createElement("div",null,u.a.createElement("div",null,u.a.createElement("div",null,u.a.createElement(Nt.Document,{file:t,onLoadSuccess:this.onDocumentLoadSuccess,options:At},Array.from(new Array(e),function(e,t){return u.a.createElement(Nt.Page,{key:"page_".concat(t+1),pageNumber:t+1,renderMode:"svg"})})))))}}]),t}(s.Component),Mt=h.a.Content,Pt=Object(y.a)({},st,{style:{height:"48px"}}),Lt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).goBack=function(e){e.preventDefault(),a.props.history.push("".concat(zt,"/list"))},a.handleDeletePayItem=function(e){ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var t=Object(D.a)(S.a.mark(function t(){var n;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n="",e.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),B.delete("/docm/pay-item?".concat(n.substring(0,n.length-1))).then(function(e){A.a.success("\u5220\u9664\u6210\u529f"),a.refreshPage()}).catch(function(e){});case 3:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}()})},a.form=void 0,a.handleSubmit=function(){a.form&&a.form.props.form.validateFields(function(e,t){var n;e||(n=a.state.payItem?B.post:B.put,Object.assign(t,{contractId:a.state.data.id}),t.credentialTime=t.credentialTime?t.credentialTime.format("YYYY-MM-DD"):void 0,t.payTime=t.payTime?t.payTime.format("YYYY-MM-DD"):void 0,n("/docm/pay-item",t).then(function(e){"00000000"===e.data.status?(a.refreshPage(),A.a.success("\u64cd\u4f5c\u6210\u529f")):A.a.error(e.data.message)}).catch(function(e){A.a.info(e.response.data.msg)}))})},a.handlePayItemModalCancel=function(){a.setState({showPayItemForm:!1})},a.handlePreviewModalCancel=function(){a.setState({showPreview:!1})},a.state={loading:!0,data:{},fileList:[],attachmentId:void 0,showPayItemForm:!1,payItem:void 0,showPreview:!1,fileData:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.refreshPage()}},{key:"refreshPage",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0,showPayItemForm:!1},function(){B.get("/docm?id=".concat(t)).then(function(t){var a=t.data.data,n=a.attachments.map(function(e){return{uid:e.id,size:123,name:e.docName,type:"image",status:"done",response:{status:"00000000",data:[{docName:e.docName,docPath:e.docPath}]}}});e.setState({loading:!1,data:a,fileList:n})}).catch(function(e){})})}},{key:"renderToolBar",value:function(){var e=this;return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(t){t.preventDefault();var a=e.props.match.params.id;e.props.history.push("".concat(zt,"/edit/").concat(a))}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"default",onClick:this.goBack},"\u8fd4\u56de")))}},{key:"renderContent",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.fileList;return!a&&n?u.a.createElement(N.a,ut,u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"projectName",label:"\u5408\u540c\u540d\u79f0"},n.projectName)),u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"dept",label:"\u6240\u5c5e\u79d1\u5ba4"},n.dept?n.dept.name:""))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"company",label:"\u4e59\u65b9\u540d\u79f0"},n.company)),u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"projectType",label:"\u5408\u540c\u7c7b\u578b"},n.projectType))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u4e2d\u6807\u7f16\u53f7"},n.contractNum)),u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"contractTime",label:"\u5408\u540c\u7b7e\u8ba2\u65f6\u95f4"},n.contractTime))),u.a.createElement(Ve.a,{gutter:10},u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"money",label:"\u603b\u91d1\u989d"},n.money)),u.a.createElement(We.a,Pt,u.a.createElement(N.a.Item,{key:"description",label:"\u5907\u6ce8"},n.desc))),u.a.createElement(N.a.Item,Object.assign({},dt,{key:"upload",label:"\u9644\u4ef6"}),r.map(function(t,a){return u.a.createElement("div",{key:a},u.a.createElement(b.a,{key:"button_".concat(t.uid),id:t.uid,icon:"paper-clip",type:"link",href:"".concat(Y,"/doc/pre-view?id=").concat(t.uid,"&xAuthToken=").concat(sessionStorage.getItem("xAuthToken"))},t.name),u.a.createElement(Tt,{key:"fileDown_".concat(t.uid),url:"".concat(Y,"/doc/pre-view?id=").concat(t.uid,"&xAuthToken=").concat(sessionStorage.getItem("xAuthToken")),icon:"eye",type:"default",text:"\u9884\u89c8",onClick:function(t){return e.setState({showPreview:!0})},onLoad:function(t){return e.setState({fileData:t})}}))}))):u.a.createElement(De.a,{size:"large"})}},{key:"renderPayItem",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.data.payItems,l=[Object(y.a)({},mt,{title:"\u5e8f\u53f7",dataIndex:"order",key:"order",onHeaderCell:function(e){return{style:{textAlign:"center",width:"3%"}}}}),Object(y.a)({},mt,{title:"\u91d1\u989d",dataIndex:"money",key:"money"}),Object(y.a)({},mt,{title:"\u51ed\u8bc1\u53f7",dataIndex:"credentialNum",key:"credentialNum"}),Object(y.a)({},mt,{title:"\u51ed\u8bc1\u65f6\u95f4",dataIndex:"credentialTime",key:"credentialTime"}),Object(y.a)({},mt,{title:"\u4ed8\u6b3e\u65f6\u95f4",dataIndex:"payTime",key:"payTime"}),Object(y.a)({},mt,{title:"\u5907\u6ce8",dataIndex:"desc",key:"desc"}),Object(y.a)({},mt,{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",render:function(t,a){return u.a.createElement("div",null,u.a.createElement(b.a,{type:"link",onClick:function(t){e.setState({showPayItemForm:!0,payItem:a})}},"\u7f16\u8f91"),u.a.createElement(b.a,{type:"link",onClick:e.handleDeletePayItem.bind(e,[a.id])},"\u5220\u9664"))}})],o=0;return r&&r.forEach(function(e){return o+=e.money}),a?u.a.createElement(De.a,{size:"large"}):u.a.createElement(le.a,{columns:l,dataSource:r,rowKey:"id",size:"small",bordered:!0,pagination:!1,title:function(){return u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{flex:1}},u.a.createElement("h2",null,"\u4ed8\u6b3e\u9879")),u.a.createElement("div",{style:{flex:1}},u.a.createElement("h4",null,"\u5408\u8ba1\uff1a".concat(o))),u.a.createElement("div",{style:{flex:1}},u.a.createElement("h4",null,"\u767e\u5206\u6bd4\uff1a".concat((Math.round(100*o/n.money*100)/100).toFixed(2),"%"))),u.a.createElement("div",{style:{flex:1}},u.a.createElement(b.a,{style:{float:"right"},type:"ghost",onClick:function(){e.setState({showPayItemForm:!0,payItem:void 0})}},"\u6dfb\u52a0")))}})}},{key:"renderPayItemModal",value:function(){var e=this,t=this.state,a=t.showPayItemForm,n=t.payItem;return u.a.createElement(ce.a,{title:"\u6dfb\u52a0\u4ed8\u6b3e\u9879",visible:a,onCancel:this.handlePayItemModalCancel,onOk:this.handleSubmit,destroyOnClose:!0},u.a.createElement(It,{data:n,wrappedComponentRef:function(t){return e.form=t}}))}},{key:"renderPreviewModal",value:function(){var e=this.state.showPreview,t=this.state.fileData;return u.a.createElement(ce.a,{title:"\u9884\u89c8",width:"780px",visible:e,onCancel:this.handlePreviewModalCancel,footer:null,destroyOnClose:!0},u.a.createElement(Ft,{fileData:t}))}},{key:"render",value:function(){return u.a.createElement(Mt,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},this.renderToolBar()),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent(),this.renderPayItem()),u.a.createElement("div",null,this.renderPayItemModal()),u.a.createElement("div",null,this.renderPreviewModal()))}}]),t}(u.a.Component),Yt=Object(f.g)(Lt),zt="/main/docm",Bt=h.a.Sider,Rt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(h.a,null,u.a.createElement(Bt,{width:0}),u.a.createElement(h.a,null,u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:zt,exact:!0,to:"".concat(zt,"/list")}),u.a.createElement(qe,{path:"".concat(zt,"/list"),permission:["DOCM_LIST_VIEW","DOCM_LIST_DEPT_VIEW"],component:nt}),u.a.createElement(qe,{path:"".concat(zt,"/edit/:id"),permission:"DOCM_EDIT_OPER",component:wt}),u.a.createElement(qe,{path:"".concat(zt,"/add"),permission:"DOCM_ADD_OPER",component:wt}),u.a.createElement(qe,{path:"".concat(zt,"/view/:id"),permission:"DOCM_DETAIL_VIEW",component:Yt}),u.a.createElement(f.a,{path:"".concat(zt,"/**"),to:"".concat(zt,"/list")})))))))}}]),t}(u.a.Component),Kt=Object(f.g)(Rt),Ht=(a(651),a(652),h.a.Content),_t={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},Ut=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"renderContent",value:function(){return u.a.createElement(wa.Consumer,null,function(e){return u.a.createElement(N.a,_t,u.a.createElement(N.a.Item,{key:"username",label:"\u7528\u6237\u540d"},e.username),u.a.createElement(N.a.Item,{key:"phone",label:"\u624b\u673a"},e.phone),u.a.createElement(N.a.Item,{key:"email",label:"\u90ae\u7bb1"},e.email),u.a.createElement(N.a.Item,{key:"dept",label:"\u79d1\u5ba4"},e.dept?e.dept.name:""))})}},{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,{separator:">"},u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u6211\u7684\u8d26\u53f7"),u.a.createElement(x.a.Item,null,"\u8d26\u53f7\u4fe1\u606f")),u.a.createElement(Ht,null,u.a.createElement("div",{className:"view-page-content"},this.renderContent()))))}}]),t}(u.a.Component),qt=Object(f.g)(Ut),Vt=h.a.Content,Wt={labelCol:{xs:{span:20},sm:{span:4}},wrapperCol:{xs:{span:20},sm:{span:16}}},$t={wrapperCol:{xs:{span:2,offset:0},sm:{span:2,offset:4}}},Gt=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).form=void 0,a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(e,t){if(!e){var n=t.id,r=t.oldPassword,l=t.password,o={id:n,oldPassword:K()(r),password:K()(l)};B.post("/account/mod-pwd",o).then(function(e){"00000000"===e.data.status?(A.a.success("\u4fee\u6539\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55"),sessionStorage.removeItem("userId"),a.props.history.push("".concat(Qt,"/mod-pwd"))):A.a.error(e.data.message)}).catch(function(e){A.a.error(e.response.data.message)})}})},a.state={id:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"renderContent",value:function(){var e=this;return u.a.createElement(wa.Consumer,null,function(t){var a=t.id;return e.state.id?e.form&&e.form.props.form.setFieldsValue({id:a}):e.setState({id:a}),u.a.createElement("div",null,u.a.createElement(Xt,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(N.a,$t,u.a.createElement(N.a.Item,null,u.a.createElement(b.a,{block:!0,type:"primary",onClick:e.handleSubmit},"\u63d0\u4ea4"))))})}},{key:"render",value:function(){return u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,{separator:">"},u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,null,"\u6211\u7684\u8d26\u53f7"),u.a.createElement(x.a.Item,null,"\u4fee\u6539\u5bc6\u7801")),u.a.createElement(Vt,null,u.a.createElement("div",{className:"view-page-content"},this.renderContent()))))}}]),t}(u.a.Component),Zt=Object(f.g)(Gt),Jt=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form,t=e.getFieldDecorator,a=e.getFieldValue;return u.a.createElement(N.a,Wt,t("id")(u.a.createElement(I.a,{hidden:!0})),u.a.createElement(N.a.Item,{key:"oldPassword",label:"\u539f\u5bc6\u7801"},t("oldPassword",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u65e7\u5bc6\u7801",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password"}))),u.a.createElement(N.a.Item,{key:"password",label:"\u65b0\u5bc6\u7801"},t("password",{rules:[{required:!0,message:"\u5bc6\u7801\u4e3a4~16\u4f4d\u4efb\u610f\u5b57\u7b26",pattern:/^.{4,16}$/}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"}))),u.a.createElement(N.a.Item,{key:"confirmPassword",label:"\u786e\u8ba4\u5bc6\u7801"},t("confirmPassword",{rules:[{message:"\u4e24\u6b21\u8f93\u5165\u5bc6\u7801\u4e0d\u4e00\u81f4",validator:function(){var e=Object(D.a)(S.a.mark(function e(t,n,r,l,o){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a("password")!==n?r("error"):r();case 2:case"end":return e.stop()}},e)}));return function(t,a,n,r,l){return e.apply(this,arguments)}}()}],validateTrigger:"onBlur"})(u.a.createElement(I.a,{type:"password",placeholder:"\u8bf7\u518d\u6b21\u8f93\u5165\u5bc6\u7801"}))))}}]),t}(u.a.Component),Xt=N.a.create({name:"mod_pwd"})(Jt),Qt="/main/account",ea=h.a.Sider,ta=["/info","/mod-pwd"],aa=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,selectedKeys:[]},a.handleOnSelect=function(e){var t=e.key;a.setState({selectedKeys:[t]}),a.props.history.push("".concat(Qt).concat(t))},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this.fetchDefaultSelectedKey();this.handleOnSelect({key:e})}},{key:"fetchDefaultSelectedKey",value:function(){var e=this.props.location.pathname,t=ta.filter(function(t){return e.indexOf(t)>=0});return t.length<1?ta[0]:t[0]}},{key:"render",value:function(){var e=this.state.selectedKeys;return u.a.createElement(h.a,null,u.a.createElement(ea,{width:180,theme:"dark",collapsed:this.state.collapsed,collapsedWidth:80},u.a.createElement("span",{className:"aside-top",onClick:this.toggleCollapsed},u.a.createElement(v.a,{style:{margin:"0 0 0 10px"},type:this.state.collapsed?"menu-unfold":"menu-fold"})),u.a.createElement(E.b,{selectedKeys:e,mode:"inline",theme:"dark",onSelect:this.handleOnSelect},u.a.createElement(E.b.Item,{className:"aside-item",key:"/info"},u.a.createElement(v.a,{type:"user"}),u.a.createElement("span",null,"\u8d26\u53f7\u4fe1\u606f")),u.a.createElement(E.b.Item,{className:"aside-item",key:"/mod-pwd"},u.a.createElement(v.a,{type:"safety"}),u.a.createElement("span",null,"\u4fee\u6539\u5bc6\u7801")))),u.a.createElement(h.a,null,u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(qe,{path:"".concat(Qt,"/info"),component:qt}),u.a.createElement(qe,{path:"".concat(Qt,"/mod-pwd"),component:Zt})))))}}]),t}(u.a.Component),na=Object(f.g)(aa),ra=(a(283),a(80)),la=(a(653),a(236)),oa=F.a.Option,ca=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).fetchUser=function(e){var t={pageSize:100,current:1,conditions:{keywordUsername:e},sorters:{username:"asc"}};a.setState({data:[],loading:!0}),setTimeout(function(){B.post("/user/search",t).then(function(e){var t=[];"00000000"===e.data.status&&e.data.data.content.length>0&&(t=e.data.data.content.map(function(e){return{text:e.username,value:e.username}})),a.setState({data:t,loading:!1})})},300)},a.handleChange=function(e){var t=a.props.onChange;a.setState({value:e,data:[],loading:!1}),t&&t(e)},a.fetchUser=Ge()(a.fetchUser,800),a.state={param:{conditions:{ranges:{}},sorters:{}},data:[],value:[],loading:!1},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state,t=e.loading,a=e.data,n=e.value;return u.a.createElement(F.a,{value:n,placeholder:"\u641c\u7d22\u7528\u6237",notFoundContent:t?u.a.createElement(De.a,{size:"small"}):null,filterOption:!1,showSearch:!0,onSearch:this.fetchUser,onChange:this.handleChange,showArrow:!1,allowClear:!0,style:{width:"280px"}},a.map(function(e){return u.a.createElement(oa,{key:e.value,value:e.value},e.text)}))}}]),t}(u.a.Component),ia=(a(655),h.a.Content),sa=F.a.Option,ua=la.a.Panel,da=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleListChange=function(){a.setState({loading:!0},function(){var e=a.state,t=e.pageSize,n=e.current,r=e.param,l=Object(y.a)({pageSize:t,current:n},r);B.post("/operlog/list",l).then(function(e){a.setState({loading:!1,data:e.data.data})}).catch(function(e){a.setState({loading:!1})})})},a.loadOperNames=function(){B.get("/operlog/name/list-all").then(function(e){a.setState({operNames:e.data.data})}).catch(function(e){A.a.error("\u52a0\u8f7d\u64cd\u4f5c\u540d\u79f0\u6570\u636e\u5931\u8d25")})},a.handleSelectChangeForOperator=function(e){a.state.param.conditions.operator=e,a.setState({current:1}),a.handleListChange()},a.handleSelectChangeForOperName=function(e){a.state.param.conditions.name=e,a.setState({current:1}),a.handleListChange()},a.handleDeleteOper=function(){var e=Object(D.a)(S.a.mark(function e(t){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ce.a.confirm({title:"\u786e\u5b9a\u5220\u9664?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){var e=Object(D.a)(S.a.mark(function e(){var n;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="",t.forEach(function(e){return n=n.concat("ids=".concat(e,"&"))}),e.next=4,B.delete("/operlog?".concat(n.substring(0,n.length-1)));case 4:A.a.success("\u5220\u9664\u6210\u529f"),a.handleListChange();case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()});case 1:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleCreateTimeRangeChange=function(e){var t,n=e.target.value;if("none"!==n){var r;switch(n){case"a":r=ue()().add("day",-3).format("YYYY-MM-DD HH:mm:ss");break;case"b":r=ue()().add("day",-7).format("YYYY-MM-DD HH:mm:ss");break;case"c":r=ue()().add("month",-1).format("YYYY-MM-DD HH:mm:ss");break;case"d":r=ue()().add("month",-6).format("YYYY-MM-DD HH:mm:ss")}t={start:r,end:ue()().format("YYYY-MM-DD HH:mm:ss")}}else t=void 0;a.state.param.conditions.ranges.createTime=t,a.setState({rangeOptionValue:n,current:1}),a.handleListChange()},a.state={loading:!0,selectedRowKeys:[],modules:[],data:{total:void 0,content:[]},pageSize:10,current:1,param:{conditions:{ranges:{}},sorters:{}},activeKey:"searchPanel",rangeOptionValue:"none",operNames:[]},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.handleListChange(),this.loadOperNames()}},{key:"renderPanel",value:function(){var e=this.state.rangeOptionValue;return u.a.createElement("div",null,u.a.createElement(N.a,{labelCol:{span:2,offset:0},wrapperCol:{span:16,offset:0}},u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u65f6\u95f4"},u.a.createElement("div",{style:{display:"flex",alignItems:"center"}},u.a.createElement("div",null,u.a.createElement(ra.a.Group,{value:e,onChange:this.handleCreateTimeRangeChange},u.a.createElement(ra.a.Button,{className:"radio-option",key:"none",value:"none"},"\u4e0d\u9650"),u.a.createElement(ra.a.Button,{className:"radio-option",key:"a",value:"a"},"\u8fd1\u4e09\u5929"),u.a.createElement(ra.a.Button,{className:"radio-option",key:"b",value:"b"},"\u8fd1\u4e00\u5468"),u.a.createElement(ra.a.Button,{className:"radio-option",key:"c",value:"c"},"\u8fd1\u4e00\u6708"),u.a.createElement(ra.a.Button,{className:"radio-option",key:"d",value:"d"},"\u8fd1\u534a\u5e74"))))),u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u8005"},u.a.createElement(ca,{onChange:this.handleSelectChangeForOperator}))))}},{key:"renderSearchBar",value:function(){var e=this,t=this.state,a=t.activeKey,n=t.operNames;return u.a.createElement("div",null,u.a.createElement("div",{style:{display:"flex",alignItems:"flex-start"}},u.a.createElement("div",{style:{flex:"1"}},u.a.createElement(N.a,{labelCol:{span:4,offset:0},wrapperCol:{span:8,offset:0}},u.a.createElement(N.a.Item,{label:"\u64cd\u4f5c\u540d\u79f0"},u.a.createElement(F.a,{placeholder:"\u8bf7\u9009\u62e9",style:{width:"280px"},allowClear:!0,showArrow:!0,onChange:this.handleSelectChangeForOperName},n.map(function(e){return u.a.createElement(sa,{key:e,value:e},e)}))))),u.a.createElement("div",{style:{flex:"1"}},u.a.createElement("div",{style:{float:"right"}},u.a.createElement(b.a,{type:"link",onClick:function(){return e.setState({activeKey:a?void 0:"searchPanel"})}},a?"\u6536\u8d77\u7b5b\u9009":"\u5c55\u5f00\u7b5b\u9009")))),u.a.createElement(la.a,{bordered:!1,activeKey:a},u.a.createElement(ua,{key:"searchPanel",style:{border:0},showArrow:!1,header:""},this.renderPanel())))}},{key:"renderButtonBar",value:function(){var e=this,t=this.state.selectedRowKeys;return u.a.createElement(wa.Consumer,null,function(a){var n=a.permissions.find(function(e){return"DOCM_ADD_OPER"===e.id}),r=a.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id});return u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},n&&u.a.createElement(b.a,{className:"ele-operation",type:"primary",onClick:function(){e.props.history.push("".concat(va,"/add"))}},"\u65b0\u5efa"),r&&u.a.createElement(b.a,{type:"ghost",disabled:t.length<1,onClick:function(){e.handleDeleteOper(t)}},"\u6279\u91cf\u5220\u9664")))})}},{key:"buildColumns",value:function(){var e={onHeaderCell:function(e){return{style:{textAlign:"center",width:"10%"}}},onCell:function(e,t){return{style:{textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",cursor:"pointer"}}},render:function(e){return u.a.createElement(oe.a,{placement:"topLeft",title:e},e)}};return[{title:"\u5e8f\u53f7",key:"index",render:function(e,t,a){return a+1},onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}},onCell:function(e,t){return{style:{textAlign:"center"}}}},Object(y.a)({},e,{title:"\u64cd\u4f5c\u540d\u79f0",dataIndex:"name",key:"name"}),Object(y.a)({},e,{title:"\u6a21\u5757\u540d\u79f0",dataIndex:"module",key:"module"}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u8005",dataIndex:"operator",key:"operator"}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u7ed3\u679c",dataIndex:"result",key:"result",onHeaderCell:function(e){return{style:{textAlign:"center",width:"5%"}}}}),Object(y.a)({},e,{title:"\u64cd\u4f5c\u65f6\u95f4",dataIndex:"createTime",key:"createTime",render:function(e,t,a){return ue()(t.createTime).format("YYYY-MM-DD HH:mm:ss")},sorter:function(e,t){return e.id-t.id}})]}},{key:"renderTable",value:function(){var e=this,t=this.state,a=t.loading,n=t.data,r=t.pageSize,l=t.current,o=t.selectedRowKeys,c=n.total,i=n.content;return u.a.createElement(wa.Consumer,null,function(t){var s=t.permissions.find(function(e){return"DOCM_DELETE_OPER"===e.id})?{columnWidth:"30px",selectedRowKeys:o,onChange:function(t){e.setState({selectedRowKeys:t})}}:void 0;return a||n.content.length>0?u.a.createElement(le.a,{rowKey:function(e){return e.id},rowSelection:s,columns:e.buildColumns(),dataSource:i,loading:a,onRow:function(t,a){return{onClick:function(a){"TD"===a.target.tagName&&e.props.history.push("".concat(va,"/view/").concat(t.id))}}},size:"small",pagination:{total:c,current:l,pageSize:r,pageSizeOptions:["10","20","50"],showSizeChanger:!0,onShowSizeChange:function(t,a){e.setState({current:1,pageSize:a})},showTotal:function(e){return"\u5171 ".concat(e," \u6761")}},onChange:function(t,a,n,r){var l=e.state.param,o=t.current,c=t.pageSize,i=n.field,s=n.order;l.sorters={},i&&s&&(l.sorters[pe(i)]=function(e){return"descend"===e?"desc":"asc"}(s)),e.setState({current:o,pageSize:c}),e.handleListChange()}}):u.a.createElement(re.a,{description:"\u6682\u65e0\u5185\u5bb9"})})}},{key:"render",value:function(){return u.a.createElement(ia,null,u.a.createElement("div",{className:"list-page"},u.a.createElement("div",{className:"list-page-content"},u.a.createElement("div",{className:"list-page-content-toolbar"},this.renderSearchBar()),u.a.createElement("div",{className:"list-page-content-buttonbar"},this.renderButtonBar()),u.a.createElement("div",{className:"list-page-content-table"},this.renderTable()))))}}]),t}(u.a.Component);var ma=Object(f.g)(da),pa=h.a.Content,fa={span:12,offset:0},ha={labelCol:{span:4,offset:2},wrapperCol:{span:16,offset:0}},ya=function(e){function t(e){var a;return Object(r.a)(this,t),(a=Object(o.a)(this,Object(c.a)(t).call(this,e))).handleCancel=function(e){e.preventDefault(),a.props.history.push("".concat(va,"/list"))},a.state={loading:!0,data:void 0},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.setState({loading:!0},function(){B.get("/operlog?id=".concat(t)).then(function(t){e.setState({loading:!1,data:t.data.data})}).catch(function(e){})})}},{key:"renderContent",value:function(){var e=this.state,t=e.loading,a=e.data;return!t&&a?u.a.createElement(N.a,ha,u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"name",label:"\u64cd\u4f5c\u540d\u79f0"},a.name)),u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"module",label:"\u6a21\u5757\u540d\u79f0"},a.module))),u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"operator",label:"\u64cd\u4f5c\u8005"},a.operator)),u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"createTime",label:"\u64cd\u4f5c\u65f6\u95f4"},a.createTime))),u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"result",label:"\u64cd\u4f5c\u7ed3\u679c"},a.result))),u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"ip",label:"\u8fdc\u7a0bIP"},a.ip)),u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"userAgent",label:"UserAgent"},a.userAgent))),u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"method",label:"HTTP\u65b9\u6cd5"},a.method)),u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"url",label:"URL"},a.url))),u.a.createElement(Ve.a,null,u.a.createElement(We.a,fa,u.a.createElement(N.a.Item,{key:"contractNum",label:"\u64cd\u4f5c\u5185\u5bb9"},a.content)),u.a.createElement(We.a,fa))):u.a.createElement(De.a,{size:"large"})}},{key:"render",value:function(){return u.a.createElement(pa,null,u.a.createElement("div",{style:{margin:"4px 4px 10px",display:"flex",alignItems:"center"}},u.a.createElement("div",{style:{margin:"4px",flex:1}},u.a.createElement("span",{style:{float:"right"}},u.a.createElement(b.a,{type:"default",onClick:this.handleCancel},"\u8fd4\u56de")))),u.a.createElement("div",{style:{margin:"8px"}},this.renderContent()))}}]),t}(u.a.Component),ga=Object(f.g)(ya),va="/main/operlog",Ea=h.a.Sider,ba=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.location.pathname;return a.indexOf("".concat(va,"/view"))>=0?e="\u8be6\u60c5":a.indexOf("".concat(va,"/list"))>=0&&(e="\u67e5\u8be2"),u.a.createElement(h.a,null,u.a.createElement(Ea,{width:0}),u.a.createElement(h.a,null,u.a.createElement("div",{className:"layout-content"},u.a.createElement("div",{className:"layout-content-inner"},u.a.createElement(x.a,null,u.a.createElement(x.a.Item,null,"\u5f53\u524d\u4f4d\u7f6e\uff1a"),u.a.createElement(x.a.Item,{onClick:function(){return t.props.history.push("".concat(va))}},"\u65e5\u5fd7\u5ba1\u8ba1"),u.a.createElement(x.a.Item,null,e)),u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:va,exact:!0,to:"".concat(va,"/list")}),u.a.createElement(qe,{path:"".concat(va,"/list"),component:ma}),u.a.createElement(qe,{path:"".concat(va,"/view/:id"),component:ga}),u.a.createElement(f.a,{path:"".concat(va,"/**"),to:"".concat(va,"/list")})))))))}}]),t}(u.a.Component),ka=Object(f.g)(ba),Ca=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(wa.Consumer,null,function(e){var t=k.filter(function(t){return!!e.username&&("admin"===e.username?t.role.filter(function(e){return"admin"===e}).length>0:t.role.filter(function(e){return"normal"===e}).length>0)}),a=[{key:"/docm",value:u.a.createElement(f.b,{key:"docm",path:"/main/docm",component:Kt})},{key:"/user",value:u.a.createElement(f.b,{key:"user",path:"/main/user",component:He})},{key:"/account",value:u.a.createElement(f.b,{key:"account",path:"/main/account",component:na})},{key:"/operlog",value:u.a.createElement(f.b,{key:"operlog",path:"/main/operlog",component:ka})}];return t.length>0&&u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"/main",exact:!0,to:"/main".concat(t[0].key)}),a.filter(function(e){return t.filter(function(t){return t.key===e.key}).length>0}).map(function(e){return e.value})))})}}]),t}(u.a.Component),Oa=Object(f.g)(Ca),wa=(a(656),u.a.createContext({})),xa=function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).state={collapsed:!1,userInfo:{}},a.toggleCollapsed=function(){a.setState({collapsed:!a.state.collapsed})},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;B.get("/account?id=".concat(sessionStorage.getItem("userId"))).then(function(t){var a=Object(y.a)({},t.data.data);e.setState({userInfo:a})}).catch(function(e){})}},{key:"render",value:function(){var e=this.state.userInfo;return e.id?u.a.createElement(wa.Provider,{value:e},u.a.createElement(h.a,{className:"ant-layout-home"},u.a.createElement(w,null),u.a.createElement(Oa,null))):u.a.createElement("div",null)}}]),t}(s.Component),ja=a(326),Sa=a.n(ja),Da=a(327),Ia=a.n(Da),Ta=(a(657),function(e){function t(){var e,a;Object(r.a)(this,t);for(var n=arguments.length,l=new Array(n),i=0;i<n;i++)l[i]=arguments[i];return(a=Object(o.a)(this,(e=Object(c.a)(t)).call.apply(e,[this].concat(l)))).form=void 0,a.handleSubmit=function(e){e.preventDefault(),a.form&&a.form.props.form.validateFields(function(){var e=Object(D.a)(S.a.mark(function e(t,n){var r;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=4;break}return r=K()(n.password),e.next=4,B.post("/account/login",Object(y.a)({},n,{password:r})).then(function(e){"00000000"===e.data.status?(sessionStorage.setItem("userId",e.data.data.id),setTimeout(function(){a.props.history.push("/main")},300)):a.form&&a.form.props.form.setFields({password:{value:n.password,errors:[new Error(e.data.message)]}})}).catch(function(e){A.a.error("\u670d\u52a1\u5668\u5f02\u5e38")});case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())},a}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return u.a.createElement("div",{className:"login"},u.a.createElement("img",{className:"login-img",src:Sa.a,alt:""}),u.a.createElement("div",{className:"login-form"},u.a.createElement("div",{className:"login-form-top"},u.a.createElement("div",{className:"logo"},u.a.createElement("a",{href:"/"},u.a.createElement("img",{className:"logo-img",src:Ia.a,alt:"logo"}),u.a.createElement("span",{className:"logo-text"},"Contract MS"))),u.a.createElement("div",{className:"logo-desc"},"\u6b22\u8fce\u767b\u5f55\u5408\u540c\u7ba1\u7406\u7cfb\u7edf")),u.a.createElement(Fa,{wrappedComponentRef:function(t){e.form=t}}),u.a.createElement(b.a,{className:"login-form-item",type:"primary",onClick:this.handleSubmit},"\u767b\u5f55")),u.a.createElement("div",{className:"copyright"}))}}]),t}(u.a.Component)),Na=Object(f.g)(Ta),Aa=function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return u.a.createElement(N.a,{layout:"vertical"},u.a.createElement(N.a.Item,null,e("username",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]})(u.a.createElement(I.a,{className:"login-form-item",prefix:u.a.createElement(v.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"\u7528\u6237\u540d"}))),u.a.createElement(N.a.Item,null,e("password",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801"}]})(u.a.createElement(I.a,{className:"login-form-item",prefix:u.a.createElement(v.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"\u5bc6\u7801"}))))}}]),t}(u.a.Component),Fa=N.a.create({name:"normal_login"})(Aa),Ma=a(330),Pa=(a(658),a(659),function(e){function t(){return Object(r.a)(this,t),Object(o.a)(this,Object(c.a)(t).apply(this,arguments))}return Object(i.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return u.a.createElement(n.a,{locale:Ma.a},u.a.createElement(p.a,null,u.a.createElement(f.d,null,u.a.createElement(f.a,{path:"/",exact:!0,to:"/main"}),u.a.createElement(f.b,{path:"/login",component:Na}),u.a.createElement(qe,{path:"/main",component:xa}))))}}]),t}(s.PureComponent));m.a.render(u.a.createElement(Pa,null),document.getElementById("root"))}},[[336,1,2]]]);
//# sourceMappingURL=main.0a90e867.chunk.js.map